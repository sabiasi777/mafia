<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mafia Game</title>
  <link rel="stylesheet" href="../assets/css/index.css">
</head>
<body>
  <div class="container">
    <div class="game-card">
      <div class="game-header">
        <h1 class="game-title">MAFIA</h1>
        <p class="game-subtitle">Deception â€¢ Strategy â€¢ Survival</p>
      </div>

      <!-- Join Room Section -->
      <div class="form-section">
        <h2 class="section-title">Join Game</h2>
        <form action="http://localhost:8080/join" method="POST" id="joinForm">
          <input type="text" class="input-field" id="nameInput" name="username" placeholder="Enter your name" required />
          <input type="text" class="input-field" id="roomInput" name="roomcode" placeholder="Enter room code" required />
          <button type="submit" class="btn btn-primary">Join Game</button>
        </form>
      </div>

      <div class="divider">
        <span>OR</span>
      </div>

      <!-- Create Room Section -->
      <div class="form-section">
        <h2 class="section-title">Create Room</h2>
        <form action="http://localhost:8080/create" method="POST">
          <input type="text" class="input-field" name="username" placeholder="Your name" required />
          <button type="submit" class="btn btn-secondary">Create New Room</button>
        </form>
      </div>

      <div class="rules-section">
        <button id="rulesBtn" class="rules-btn">ðŸ“– Game Rules</button>
      </div>
    </div>
  </div>

  <!-- Rules Modal -->
  <div id="rulesModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Game Rules</h2>
        <button id="closeRules" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <p>Mafia is a social deduction game where players are divided into two main factions: the <strong>Town</strong> and the <strong>Mafia</strong>. The goal is to eliminate the opposing faction through strategy, deception, and careful analysis.</p>

        <h3>ðŸŽ¯ Objective</h3>
        <p><strong>Town:</strong> Identify and eliminate all Mafia members.<br>
        <strong>Mafia:</strong> Eliminate enough Town members to equal or outnumber them.</p>

        <h3>ðŸ‘¥ Roles</h3>
        <ul>
          <li>
            <div>
              <strong>Mafia:</strong> Work together to eliminate Town members during the night phase. They know each other's identities and can communicate secretly.
            </div>
          </li>
          <li>
            <div>
              <strong>Detective:</strong> Can investigate one player each night to learn if they are Mafia or Town. This information is crucial for guiding Town decisions.
            </div>
          </li>
          <li>
            <div>
              <strong>Doctor:</strong> Can protect one player each night from being eliminated. They can even protect themselves, but cannot protect the same person twice in a row.
            </div>
          </li>
          <li>
            <div>
              <strong>Villager:</strong> Regular Town members who must use logic, observation, and discussion to identify Mafia members during the day phase.
            </div>
          </li>
        </ul>

        <h3>ðŸŒ™ Game Flow</h3>
        <p><strong>Night Phase:</strong> All players close their eyes. Mafia members choose a target to eliminate. Special roles (Detective, Doctor) perform their actions.</p>
        <p><strong>Day Phase:</strong> Players discuss who they suspect is Mafia and vote to eliminate someone. The player with the most votes is eliminated.</p>
        <p>The game alternates between these phases until one faction achieves their win condition.</p>
      </div>
    </div>
  </div>

  <script>
    const rulesBtn = document.getElementById('rulesBtn');
    const rulesModal = document.getElementById('rulesModal');
    const closeRules = document.getElementById('closeRules');

    function showModal() {
      rulesModal.classList.add('show');
      document.body.style.overflow = 'hidden';
    }

    function hideModal() {
      rulesModal.classList.remove('show');
      document.body.style.overflow = 'auto';
    }

    rulesBtn.addEventListener('click', showModal);
    closeRules.addEventListener('click', hideModal);

    rulesModal.addEventListener('click', (event) => {
      if (event.target === rulesModal) {
        hideModal();
      }
    });

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape' && rulesModal.classList.contains('show')) {
        hideModal();
      }
    });
    
    const gameCard = document.querySelector('.game-card');
    let floatDirection = 1;
    
    setInterval(() => {
      const currentTransform = gameCard.style.transform || 'translateY(0px)';
      const currentY = parseFloat(currentTransform.match(/translateY\(([^)]+)\)/)?.[1] || 0);
      
      if (currentY >= 3) floatDirection = -1;
      if (currentY <= -3) floatDirection = 1;
      
      gameCard.style.transform = `translateY(${currentY + (floatDirection * 0.1)}px)`;
    }, 100);
  </script>
</body>
</html>